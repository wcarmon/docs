# Useful for collecting spans from browser
#
# See official example:
# https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/examples/tracing/otel-collector-config.yml

# ---------------------
# -- Input side
# ---------------------
# See https://github.com/open-telemetry/opentelemetry-collector/tree/main/receiver/otlpreceiver
# See https://github.com/open-telemetry/opentelemetry-collector/blob/main/config/confighttp/README.md#server-configuration
# CORS: see https://github.com/open-telemetry/opentelemetry-collector/blob/main/receiver/otlpreceiver/config.md#confighttp-corssettings
# CORS: see https://github.com/open-telemetry/opentelemetry-collector/tree/main/receiver/otlpreceiver#cors-cross-origin-resource-sharing
# Port 4318 for http
receivers:
  otlp:
    protocols:
      http:
        endpoint: "localhost:4318"
        cors:
          allowed_origins:
            - "*"
          allowed_headers:
            - "*"
          max_age: 7200  # seconds

# TODO: verify
# Access-Control-Allow-Origin
# Access-Control-Allow-Methods
# Access-Control-Allow-Headers


# ---------------------
# -- Output side
# ---------------------
# See https://github.com/open-telemetry/opentelemetry-collector/blob/main/exporter/otlpexporter/cfg-schema.yaml
exporters:
  jaeger:
    endpoint: localhost:14250
    tls:
      insecure: true
  logging:
    verbosity: detailed


# ---------------------
# -- Internal
# ---------------------
processors:
  batch:

extensions:
  health_check:

service:
  extensions: [health_check]
  pipelines:
    traces:
      receivers: [otlp]
      exporters: [jaeger, logging]
      processors: [batch]
